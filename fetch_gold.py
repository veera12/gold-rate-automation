import requests from bs4 import BeautifulSoup URL = "https://www.goodreturns.in/gold-rates/madurai.html" NTFY_TOPIC = "https://ntfy.sh/madurai-gold-rate-veer" html = requests.get(URL, timeout=15).text soup = BeautifulSoup(html, "html.parser") # Find the gold rate table table = soup.find("table") rows = table.find_all("tr") prices = [] for row in rows[1:8]: # header skipped, take last 7 days cols = row.find_all("td") if len(cols) >= 3: date = cols[0].get_text(strip=True) gold_22k = cols[1].get_text(strip=True) gold_24k = cols[2].get_text(strip=True) prices.append({ "date": date, "22k": gold_22k, "24k": gold_24k }) # Reverse to make oldest â†’ newest prices.reverse() today = prices[-1] yesterday = prices[-2] def extract_number(price_str): return float( price_str.replace("â‚¹", "").replace(",", "").strip() ) today_22 = extract_number(today["22k"]) yesterday_22 = extract_number(yesterday["22k"]) diff = today_22 - yesterday_22 arrow = "ğŸ“ˆ" if diff > 0 else "ğŸ“‰" if diff < 0 else "â¡ï¸" # Build notification text message = "ğŸ… Madurai Gold Rate (Last 7 Days)\n\n" for p in prices: message += f"{p['date']}: 22K {p['22k']} | 24K {p['24k']}\n" message += ( f"\nToday Change (22K): {arrow} â‚¹{diff:.2f}" ) # Send notification requests.post( NTFY_TOPIC, data=message.encode("utf-8") )
